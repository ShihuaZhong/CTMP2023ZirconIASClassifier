This repository contains machine learning Python code and ZirconISAClassifier software used in the manuscript "A machine learning method for distinguishing detrital zircon provenance " (Zhong et al., 2023, Contributions to Mineralogy and Petrology).

IMPORTANT: We updated the softare interface on 2th June, 2023. It is noted that this modification does not influence the output results.

CONTENTS:

[Machine learning Code]: This code can be used to reproduce the results shown in Zhong et al.(2023, Contributions to Mineralogy and Petrology). Users must download all the files to get the results. The .py file contains trained algorithms for Support Vector Machine (SVM), Random Forest (RF), and Multilayer Perceptron (MLP). It can also be used to predict the source rocks of users' zircons. Please see the article for more details.The whole dataset was randomly divided into a training and a test set at a ratio of 8:2 but the procedure was not shown in the code. We just here provides the final used divisiion datasets which were used to produce the performance results in this paper. The enclosed x_train.txt (zircon trace element data) and y_train.txt files (their labels) correspond to the training set; in contrast, x_val.txt and y_val.txt files correspond to the test set. x_val.txt and y_val.txt files can also be replaced by users' data to predict the source rocks of their zircons. The whole database consists of 1442 zircon grains from I-type granites, 1051 from S-type granites, and 1301 from A-type granites with 11 variables—including Ce, Eu, Ho, Nb, Ta, Th, U, Th/U, U/Yb, Ce/Ce* and Eu/Eu*. The sources and details of the zircon data can be found in Online Resource 2 of this paper.

[ZirconISAClassifier Software]: This directory contains a software for predicting the source rocks of (detrital) zircons, which is based on the machine learning training result in the paper mentioned above; any revision to our training ML algorithms or to the training database will likely generate a different classification result. The idea behind the software is to provide the community of igneous petrologists and geochemists with a user-friendly interface to easily get the zircon classification results of their zircon data, without requirements of any knowledge of computer programming and machine learning algorithms; basic computer literacy is sufficient manipulating and processing geochemical data. 

To use this software, users should download all the files in this directory. To double-click the .exe file will directly enter the main interface. Then, users can click the “Enter” button on the main interface to access the Input Data interface. This interface allows users to upload the zircon data files (either .txt or .csv format) by clicking the “Open” button and the “Submit” button. 11 features in the input file must be listed in the following order: Ce, Eu, Ho, Nb, Ta, Th, U, Th/U, U/Yb, Ce/Ce*, and Eu/Eu*. Then, click the “Next” button to enter into Choose ML Model interface. The Choose ML Model interface offers three available machine learning models which are used in this study. After this, users will enter the Automatic Prediction interface. In this new interface, the software can automatically predict the raw data and show the prediction results by clicking the “Predict” button. The “Statistics” button helps to calculate the percentage of three types of zircons in the prediction results. Finally, the classification results can be saved to your computer in a .txt or .csv. format.

